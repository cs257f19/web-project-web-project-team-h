<!DOCTYPE html>
<html lang="en">
<head>
  <title>Sample Landlord Result Page</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="{{ url_for('static', filename='overallPage.css') }}">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
  integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
  crossorigin="">
  <!-- Make sure you put this AFTER Leaflet's CSS -->
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
  integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
  crossorigin=""></script>
</head>
<body>
  <header>
    <div class="tag">
      <a href = "{{ url_for('homePage') }}"><h1>Airbnb in NYC</h1></a>
      <div>
        <p>All you need to know about Airbnb in NYC</p>
      </div>
    </div>
    <nav>
      <a href="{{ url_for('dataPage') }}" class="change">About the Data</a>
      <a href="#" class="change active-page">Visualize Data</a>
      <a href="{{ url_for('hostSearch') }}" class="change">For Hosts</a>
      <a href="{{ url_for('listingSearch') }}" class="change">Listing Search</a>
    </nav>
  </header>

  <section>
    <h3>
      Have a better understanding of how Airbnb is really being used and how it impacts your neighborhood.
    </h3>
  </section>

  <section>
   <div class="info">
    <div>
      <h3>Activity</h3>
      <p>Airbnb guests may leave a review after their stay, and these can be used as an indicator of airbnb
      activity (although not all guests leave a review, so the actual booking activity would be much higher).</p>
      <div class="data">
        <div id="my_dataviz" class="dataviz"></div>
        <div>
          <ul>
            <li>Average 112 nights/year</li>
            <li>On average 1.1{{ average_reviews_per_month }} reviews/listing/month</li>
            <li>Total 1,143,036{{ total_reviews }} reviews</li>
            <li>On average $151{{ average_price }} price/nigh</li>
          </ul>
        </div>
      </div>
    </div>
    <div>
      <h3>Room Type</h3>
      <p>Airbnb hosts can list entire homes/apartments, private or shared rooms.</p>
      <div class="data">
        <div id="my_dataviz1" class="dataviz"></div>
        <div>
          <ul>
            <li>25296{{ entire_home_count }} entire home/apartments</li>
            <li>22397{{ private_room_count }} private roome</li>
            <li>1171{{ shared_room_count }} shared rooms</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="info">
    <div>
      <h3>Availability</h3>
      <p>An Airbnb host can setup a calendar for their listing so that it is only available for a few days or weeks a year.
      Somel listings are available all year round.</p>
      <div class="data">
        <div id="my_dataviz2" class="dataviz"></div>
        <div>
          <ul>
            <li>On average 112.5{{ average_availability }} days/year</li>
          </ul>
        </div>
      </div>
    </div>
    <div>
      <h3>Listings per Host</h3>
      <p>Some Airbnb hosts have multiple listings.
      A host may list separate rooms in the same apartment, or multiple apartments or homes available in their entirity.</p>
      <div class="data">
        <div id="my_dataviz3" class="dataviz"></div>
        <div>
          <ul>
            <li>32203{{ host_single_count }}hosts with single listings</li>
            <li>16661{{ host_multiple_count }}hosts with multi listings</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="mapSection">
  <h2>Houses in the same neighborhood with the same room type</h2>
  <div id="mapid"></div>
</section>
<script src="https://d3js.org/d3.v4.js"> </script>
<script>
  var myIcon = L.icon({
    iconUrl: '{{ url_for('static', filename='icon1.png') }}',
    iconSize:     [6, 6],
    iconAnchor:   [22, 94],
    iconAnchor:   [6, 6],
    popupAnchor:  [-3, -6]
  });
  var myIcon1 = L.icon({
    iconUrl: '{{ url_for('static', filename='icon2.png') }}',
    iconSize:     [6, 6],
    iconAnchor:   [22, 94],
    iconAnchor:   [6, 6],
    popupAnchor:  [-3, -6]
  });
  var myIcon2 = L.icon({
    iconUrl: '{{ url_for('static', filename='icon3.jpg') }}',
    iconSize:     [6, 6],
    iconAnchor:   [22, 94],
    iconAnchor:   [6, 6],
    popupAnchor:  [-3, -6]
  });
  var entire_home_apt = new L.LayerGroup();
  var private_room = new L.LayerGroup();
  var shared_room = new L.LayerGroup();
  var mymap = L.map('mapid').setView([40.730610, -73.975242], 11);
  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiemhhbmdzMTIzIiwiYSI6ImNrMXR6NjZobzAweW0zY3BrcnB4YmF6M3YifQ.nHmNai_UTcEJdy1VTbCXfg', {
   attribution: '',
   maxZoom: 18,
   id: 'mapbox.streets',
   accessToken: 'your.mapbox.access.token'
 }).addTo(mymap);
  var locations = [["Clean & quiet apt home by the park", 40.64749, -73.97237],
  ["Large and Cozy Private Bedroom", 40.64106, -73.97426],
  ["SUPER BIG AND COZY PRIVATE BEDROOM", 40.64302, -73.97255],
  ["Private clean pleasant spacious room.", 40.64277, -73.97296],
  ["QUIET, SPACIOUS, COMFORTABLE, & GREAT LOCATION", 40.64573, -73.98013],
  ["Vintage Chic Haven in Kensington, Brooklyn", 40.63547, -73.97417],
  ["private spacious sunny bedroom", 40.63381, -73.9714],
  ["Cozy Retreat in Brooklyn Apartment", 40.6412, -73.9786],
  ["Welcome to Kensington", 40.63402, -73.97556],
  ["Two Porches & Private Room", 40.6413, -73.98233]
  ];
       // create popup contents
       var customPopup = "<p><strong>Name</strong></p><strong>Listing ID</strong><p>neigiboorhood</p><p>neighborhood group</p><p>room type</p><strong>price</strong></p>minimum night</p><p>revieus per month</p><p>Availability</p>";

    // specify popup options
    var customOptions =
    {
      'maxWidth': '500',
      'className' : 'custom'
    }
    for (var i = 0; i < locations.length; i++) {
     marker = L.marker([locations[i][1],locations[i][2]], {icon: myIcon}).bindPopup(customPopup,customOptions).addTo(entire_home_apt);
     marker1 = L.marker([locations[i][1]+0.02,locations[i][2]], {icon: myIcon1}).bindPopup(customPopup,customOptions).addTo(private_room);
     marker3 = L.marker([locations[i][1]+0.05,locations[i][2]], {icon: myIcon2}).bindPopup(customPopup,customOptions).addTo(shared_room);
   }

   mymap.addLayer(entire_home_apt);
   mymap.addLayer(private_room);
   mymap.addLayer(shared_room);
   var overlayMaps = {
    "Entire home/apt": entire_home_apt,
    "Private room":private_room,
    "Shared room":shared_room,
  };
  L.control.layers(null, overlayMaps).addTo(mymap);
</script>
<script>
    // create 2 data_set
    var data1 = [
    {group: "Entire home/apt", value: {{entire_home_count}}},
    {group: "Private room", value: {{private_room_count}}},
    {group: "Shared room", value: {{shared_room_count}}}
    ];

    // set the dimensions and margins of the graph
    var margin = {top: 2, right: 2, bottom: 20, left: 40},
    width = 270 - margin.left - margin.right,
    height = 120 - margin.top - margin.bottom;

    // append the svg object to the body of the page
    var svg = d3.select("#my_dataviz1")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform",
      "translate(" + margin.left + "," + margin.top + ")");

    // X axis
    var x = d3.scaleBand()
    .range([ 0, width ])
    .domain(data1.map(function(d) { return d.group; }))
    .padding(0.2);
    svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x))

    // Add Y axis
    var y = d3.scaleLinear()
    .domain([0, 28000])
    .range([ height, 0]);
    svg.append("g")
    .attr("class", "myYaxis")
    .call(d3.axisLeft(y).ticks(2, "f"));

    // A function that create / update the plot for a given variable:
    function update(data) {

      var u = svg.selectAll("rect")
      .data(data)

      u
      .enter()
      .append("rect")
      .merge(u)
      .transition()
      .duration(1000)
      .attr("x", function(d) { return x(d.group); })
      .attr("y", function(d) { return y(d.value); })
      .attr("width", x.bandwidth())
      .attr("height", function(d) { return height - y(d.value); })
      .attr("fill", "#69b3a2")
    }

    // Initialize the plot with the first dataset
    update(data1)

  </script>
  <script>
    // create 2 data_set
    var listings = [];

    var maxNumListing = 0;
    var count = 1;

    {% for listing in host_listings %}
        {% for key, value in listing.items() %}
           if (key>maxNumListing) {
               maxNumListing = key;
           }
        {% endfor %}
    {% endfor %}

    while (count<maxNumListing){
        {% if count in host_listings %}
        listings.push({group:count,value:host_listing[count]});
        {% else %}
        listings.push({group:count,value:0});
        {% endif %}
        count += 1;
    }
    // set the dimensions and margins of the graph
    var margin = {top: 2, right: 2, bottom: 20, left: 40},
    width = 270 - margin.left - margin.right,
    height = 120 - margin.top - margin.bottom;

    // append the svg3 object to the body of the page
    var svg3 = d3.select("#my_dataviz3")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform",
      "translate(" + margin.left + "," + margin.top + ")");

    // X axis
    var x = d3.scaleBand()
    .range([ 0, width ])
    .domain(listings.map(function(d) { return d.group; }));
    svg3.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x))

    // Add Y axis
    var y = d3.scaleLinear()
    .domain([0, 30])
    .range([ height, 0]);
    svg3.append("g")
    .attr("class", "myYaxis")
    .call(d3.axisLeft(y).ticks(2, "f"));

    // A function that create / update the plot for a given variable:
    function update(data) {

      var u = svg3.selectAll("rect")
      .data(data)

      u
      .enter()
      .append("rect")
      .merge(u)
      .transition()
      .duration(1000)
      .attr("x", function(d) { return x(d.group); })
      .attr("y", function(d) { return y(d.value); })
      .attr("width", x.bandwidth())
      .attr("height", function(d) { return height - y(d.value); })
      .attr("fill", "#69b3a2")
    }

    // Initialize the plot with the first dataset
    update(data1)

  </script>
</body>
</html>
